\chapter{Solving the Prize-Collecting Steiner Tree Problem}
\label{chap:solving}

In this chapter, we will present a survey of methods used to solve the Prize-Collecting Steiner Tree Problem. Due to the nature of solving
NP-hard combinatorial optimisation problems, this involves the the mixing and matching of methods within larger frameworks.
 After a rundown of the history of solving the PCSTP in section \ref{sec:solving:history}, we will present the following:
\begin{itemize}
\item Section \ref{sec:solving:pre} presents preprocessing algorithms used to reduce instance sizes.
\item Section \ref{sec:solving:approx} presents approximations for solving the PCSTP.
\item Section \ref{sec:solving:heuristics} presents heuristics for solving the PCSTP.
\item Section \ref{sec:solving:lower} presents methods used for generating lower bounds.
\item Section \ref{sec:solving:exact} presents frameworks and combinations of the above used find exact solutions
   to the PCSTP.
\end{itemize}

\section{History}
\label{sec:solving:history}

Solutions to the PCSTP were first explored by \citet{Bienstock1993} who
proposed a 3-approximation algorithm based on Christophides algorithm for the TSP.
This was later improved to 2-approximation algorithm by
\citet{goemans1997primal} using a primal-dual method,
which was refined and implemented
for faster runtimes and typically better
bounds by \citet{Johnson:2000:PCS:338219.338637}.

\citet{canuto2001local} presented a primal heuristic based on multi-start
local search with pertubations and path relinking.

An ILP formulation based on the General Subtour Elimination Constraint (GSEC) formulation of the Travelling Salesman Problem was
stated by \citet{lucena2004strong}, who presented an algorithm for solving the LP relaxation of the GSEC formulation using
a separation procedure as a method for generating a strong lower bound for the PCSTP. Similarly, \citet{Ljubic:2004:memetic}
presented a memetic algorithm using tournament selection and mutation. They additionally presented an ILP formulation of the Steiner
 Aborescence Problem, based on cuts, the LP-relaxation of which was solved on a subgraph extracted from the memetic algorithm to
 improve the solutions as a postprocessing step.

 \citet{ljubic2005solving} proposed the first full framework for solving the PCSTP to optimality.
 This was done by solving
 equivalent SAP instances through branch-and-cut. Solving the LP-relaxation of a cut-formulation of the SAP with a
 a separation procedure was used to generate lower bounds.
  Furthermore, they presented a set of real-world problem instances for the PCSTP based on network layout in Berlin.

  \citet{lucena2004strong}, \citet{Ljubic:2004:memetic}, and \citet{ljubic2005solving} all applied preprocessing routines
  -- known as reduction tests -- to their input graphs to reduce the size of instances.
  These were originally gathered for
  the Steiner Tree Problem by \citet{duin1989edge,duin1989reduction},
  but no reduction tests had been stated and proven for the PCSTP
  until \citeauthor{uchoa2006reduction} did so in \citeyear{uchoa2006reduction}.
  \citeauthor{uchoa2006reduction} revisited
  reduction tests originally defined for the STP,
  but also introduced a new
  novel way of determining distances between nodes,
  allowing for stronger reduction tests.

  The 11th DIMACS challenge on Steiner tree problems\footnote{\url{http://dimacs11.zib.de/}}
  brought not only a new set of instances for the PCSTP, but
  also a new wave of contributions.

  Solving the PCSTP by transforming instances into equivalent problems in directed graphs
  was revisited by \citet{leitner2016dual} and \citet{gamrath2017scip}.
  \citet{leitner2016dual} transformed instances into the Asymmetric Prize-Collecting Steiner Tree Problem (APCSTP)
  and employed a
  branch-and-bound framework generating lower bounds with a dual ascent method which was originally presented by \citet{wong1984dual} for the SAP, and
  generating incumbents with
  a shortest-path primal heuristics.
  \citet{gamrath2017scip} presented SCIP Jack -- an exact solver for STP variants based on the solver (of the STP, by way of SAP) presented by
  \citet{koch1998solving} and the MIP solver, SCIP \footnote{\url{http://scip.zib.de/}}.
  Preprocessing routines were natively applied to PCSTP instances before transforming them into SAP instances.
  The SAP was formulated as an
  ILP in a so-called \textit{Flow-Balanced Directed Cut Formulation}. The general branch-and-bound
  procedures of the SCIP optimization suite were
  then employed together with a contraint separation procedure defined in \citet{koch1998solving}.

  Developments were also made in field of heuristics for the PCSTP. \citet{fu2014knowledge} presented a tabu search and a neighbourhood definition
  using a new \textit{vertex swap} operation.
  \citet{akhmedov2016divide} presented a clustering heuristics for dividing PCSTP into subproblems,
  and additionally a
  reimplementation of the solver by \citet{ljubic2005solving} which was used to solve problems defined by the subgraphs. Additionally, they presented
  applications for the PCSTP within biology.
  \citet{biazzo2012performance} explored the performance of the cavity method on the PCSTP.
  
\input{preprocessing.tex}

\clearpage
\input{approximation.tex}

\input{heuristics.tex}

\section{Lower Bounding Procedures}
\label{sec:solving:lower}

\subsection{Generalised Subtour Elimination Constraints}
\label{sec:lower:gsec}
\citet{lucena2004strong} introduced a method for producing lower bounds for the PCSTP based on solving
the LP relaxations of the PCSTP using a constraint separation procedure.

Their main contributions
are the stating of a \textit{generalised subtour elimination constraint} ILP (see Formulation \ref{form:lower:gsec}) formulation
for the PCSTP, the separation procedure for solving the LP-relaxation, and strengthening of the formulation by considering
single vertex solution seperately.

Define the function
$$E(S) = \{(i,j) \in E \mid i \in S \wedge j \in S\}$$
then Formulation (\ref{form:lower:gsec}) is a ILP formulation of the PCSTP. Constraints (\ref{form:lower:gsec:gsec}) are
referred to as generalised subtour elimination constraints, and together with constraint (\ref{form:lower:gsec:sum})
ensure that the solution defined by $(x, y)$ is a tree which spans the vertices $y_v = 1$.

 \begin{formulation}[h!]
   \begin{subequations}
     \begin{alignat}{3} 
       &\underset{x,y}{\text{minimize}}
       & & \sum_{e \in E} c_e x_e +  \sum_{v \in V} p_v (1 - y_v)  & \\
       & \text{subject to}\quad
       & & x(E) = y(V) - 1 &&  \label{form:lower:gsec:sum}\\
       &&& x(E(S)) \leq y(S \setminus \{s\}) && \forall s \in S, S \subseteq V \label{form:lower:gsec:gsec}\\
       \intertext{ILP:}
       &&& x_e \in \BB  && \forall e \in E \\
       &&& y_v \in \BB  && \forall v \in V \\
       \intertext{LP:}
       &&& 0 \leq x_e \leq 1  && \forall e \in E \\
       &&& 0 \leq y_v \leq 1  && \forall v \in V \\
       \intertext{To exclude single vertex solutions:}
       &&& \sum_{i \in \delta(v)} x_{vi} \geq
       \begin{cases}
         y_v & p_v > 0 \\
         2y_v & p_v = 0
       \end{cases} \qquad && \forall v \in V \label{form:lower:gsec:single}
     \end{alignat}\label{form:lower:gsec}
   \end{subequations}
   \caption{(GSEC-IP) GSEC formulation of the PCSTP.}
 \end{formulation}

 Expanding the formulation with constraint (\ref{form:lower:gsec:single}), excludes single vertex solutions.
 \citet{lucena2004strong} found that adding these constraints and
 considering single vertex solutions in a separate routine results faster runtimes.

 \paragraph{Separation of GSECs} Each subset $S \in V$ produces $|S|$ GSECs. To reduce the size of the LP relaxation,
 \citet{lucena2004strong} suggest relaxing these constraints and readding them in a separation procedure.
 This separation procedure can be stated a max-flow problem as follows:

 Let $(\bar{x}, \bar{y})$ be a solution to the relaxed LP. Consider the support graph induced by vertices and edges with nonzero decision veriables,
  and vertex $l$ with decision variable $\bar y_l > 0$
  then iff
  $$\max_{S_l \subseteq V} \left\{ \bar x (E(S_l)) - (\bar y (S_l) - \bar y_l) \right\} > 0$$
  there is a violated GSEC for a subset containing $l$, and constraint corresponding to $S_l^{max}$ is the most violated constraint.

  We can model finding this subset for a given $l$ as follows. Let $\bar{N} = (\bar{V}, \bar{A})$ be a flow-network
  for the support graph, with vertices
  $$\bar V = \{s, t\} \cup \{v \in V \mid \bar y_v > 0 \}$$
  and arcs
  $$\bar A = \{(i, j) \in E \mid \bar x_{ij} > 0 \} \cup \{(j, i) \in E \mid \bar x_{ij} > 0\} \cup \{(s, v) \mid v \in \bar V\} \cup \{(v, t) \mid v \in \bar V\}\mathnormal{.}$$
  Additionally we have capacities original edges,
  $$\xi_{ij} = \xi_{ji} = \frac{\bar x_{ij}}{2} \qquad \forall (i,j) \in \bar A$$
  and if we let $\delta (v)$ be all vertices adjacent to $v$ in the support graph then node capacities are
  $$\xi_v = \sum_{u \in \delta(v)} \xi_{vu}\mathnormal{,}$$
  and finally
  for arcs from and to the source and the sink, we have
  $$\xi_{sv} =
  \begin{cases}
    \infty & v = l \\
    \max(\xi_v - \bar y_v, 0) & \text{otherwise}
  \end{cases}$$
  and
  $$\xi_{vt} = \max(\bar y - \xi_v, 0)\mathnormal{.}$$
  Then, similarly to \citet{padberg1983trees}, we can see that
  the minimum $(S,T)$ cut on the flow network will minimise
  \begin{align*}
    c(S,T) = &\sum_{v \in S} \max \left\{\bar y_v - \xi_v, 0\right\} +
               \sum_{i \in S, j \in T} \xi_{ij} +
               \sum_{v \in T} \max\left\{\xi_v - \bar y_v, 0\right\} \\
    =&\left(\sum_{v \in S} \max \left\{\bar y_v - \xi_v, 0\right\} - \sum_{v \in S} \max\left\{\xi_v - \bar y_v, 0\right\} \right) +
v       \sum_{i \in S, j \in T}  \xi_{ij} +
       \sum_{v \in V} \max\left\{\xi_v - \bar y_v, 0\right\} \\
    =&\sum_{v \in S} \bar y_v - \xi_v +
       \sum_{i \in S, j \in T} \xi_{ij} +
       \sum_{v \in V} \max\left\{\xi_v - \bar y_v, 0\right\} \\
    =&\sum_{v \in S} \bar y_v -
       \sum_{v \in S} \sum_{u \in \delta(v)} \frac{\bar x_{vu}}{2} +
       \sum_{i \in S, j \in T} \frac{\bar x_{ij}}{2} +
       \sum_{v \in V} \max\left\{\xi_v - \bar y_v, 0\right\} \\
    =&\sum_{v \in S} \bar y_v -
       \left(\sum_{i \in S} \sum_{j \in S \setminus \{i\}} \frac{\bar x_{ij}}{2} +
       \sum_{i \in S, j \in T} \frac{\bar x_{ij}}{2}\right) +
       \sum_{i \in S, j \in T} \frac{\bar x_{ij}}{2} +
       \sum_{v \in V} \max\left\{\xi_v - \bar y_v, 0\right\} \\
    =&\sum_{v \in S} \bar y_v -
       \bar x (E(S)) +
       \sum_{v \in V} \max\left\{\xi_v - \bar y_v, 0\right\}\mathnormal{.}
  \end{align*}
  Since $\sum_{v \in V} \max\left\{\xi_v - \bar y_v, 0\right\}$ is independent of
  any cuts, and
  $l$ \textit{must} be in $S$ due to $\xi_{sy} = \infty$, any minimum cut, $(S,T)$, will maximise
  $$\bar x (E(S_l)) - (\bar y (S_l) - \bar y_l)\mathnormal{.}$$
  Hence any set of vertices $S' = S \setminus \{s\}$ where $S$ induces a minimal $S,T$ cut in the flow network will correspond to
  a most violated GSEC for the solution $(\bar x, \bar y)$ to the relaxed LP.

  Finding violated GSECs then reduces to solving $|V|$ maximum flow problems, which can be done in polynomial time. However, there is guarantee
  that the $|V|$ problems will result in different violated constraints.
  To avoid adding finding the same constraints multiple times, \citet{lucena2004strong} suggest that whenever a max flow problem has been
  solved for some $l = v \in V$, then we can set $\xi_{lt} = \infty$ to avoid $v$ being on the source-side of any subsequent min-cuts.
  \todo[inline]{Wolsey (I think) suggests deleting edges/vertices from the support graph, maybe mention that}

\input{exact.tex}

%%% Local Variables:
%%% TeX-master: "report"
%%% reftex-default-bibliography: ("lit.bib")
%%% End:
